description = "Create and register a new system agent based on your description"
prompt = """
Task: Create a new system agent based on the user's description: "{{args}}".

You must perform the following actions using your tools:

1.  **Analyze Request**: Determine a unique `id`, `name`, `category` (engineering, creative, entertainment, or comedy), and `description` for the new agent.
2.  **Ensure Custom Directory**: Use `run_shell_command("mkdir -p ${extensionPath}/custom")` to ensure the custom directory exists.
3.  **Ensure Custom Registry**: If `${extensionPath}/custom/agents.json` does not exist, create it with initial content `{"agents": []}` using `write_file`.
4.  **Generate Content**: Create the system prompt content in Markdown format. It should define the persona, style, and constraints.
5.  **Write File**: Use the `write_file` tool to save this content to `${extensionPath}/custom/<id>.md`.
6.  **Update Custom Registry**:
    - Read the existing custom registry at `${extensionPath}/custom/agents.json`.
    - Append the new agent's metadata to the `agents` array. Ensure the JSON structure matches the existing format.
    - Write the updated JSON back to the file at `${extensionPath}/custom/agents.json`.

Finally, confirm the creation and provide the command to switch to the new agent.
"""